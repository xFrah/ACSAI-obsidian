SAT is NP complete, since we know from Cook-Levin theorem.


## 3-CNF-SAT

We reduce SAT to a subset of it, 3-CNF-SAT, and we use that for proving that everything else is in NP too.

Handling all the forms of the formulas in SAT problem is hard, in practice.
To simplify this, we only input formulas in [[CNF]] (Conjunctive Normal Forms).

> [!hint]
> It's called 3-CNF because each clause has 3 literals.


The cool thing of CNF is that for it to be satisfiable, at least one literal in each clause is 1. Even though if this simplifies stuff, it is still NP-Complete.
3-CNF is the last model for which it is still NP-Complete (2-CNF is polynomial)

### Reduction from SAT

In order to show that the two problems are equivalent, we need to show that **every boolean formula** φ **can be turned into an equivalent** (i.e., equi-satisfiable) **3-CNF formula**.

> [!hint]
> We want a polynomial function that turns a formula into a CNF formula, such that if the result is satisfiable, the original formula is also satisfiable.

##### Tree data structure

We construct a data structure specifically for this purpose, and we use it on the original formula (to turn it into CNF).

**Binary parse tree**:
- internal nodes = logical operators
- leaves = variables

We call the output of each internal node $y_i$.

> [!example]
> ![[Pasted image 20251129093131.png]]


##### Fitting the original formula to the tree

1. We use associativity to have only 1 or 2 children for each node (remove 3+ way clauses).
2. Start from the outermost clause, and begin building the tree from top-down. Assign symbol $y_i$ to each node.

##### Getting the new formula

**STEP 1**:
Once we have the tree, the new formula φ’ is the AND of the root variable $y_1$ and a conjunction of subformulae describing the operation of each node.

**ALL SUB-FORMULAE HAVE AT MOST 3 LITERALS**

> [!example] Explanation of **example above**
> $\leftrightarrow$ means that the two sides are logically equivalent.
> So the whole thing basically means:
> - If $y_1$ is true, with $y_1$ being equal to $(y_2 \land \lnot x_2)$
> - AND $y_2$ is equal to ($y_3 \lor y_4$)
> - AND ...


**STEP 2**:
The formula already is a conjunction, and the clauses all have at most 3 literals.
We now get the truth table for each clause, and we convert each one to CNF.


> [!example]
> ![[Pasted image 20251129102822.png]]


**STEP 3**:
Step 2 may yield clauses that have 1 or 2 literals, but we want each clause to have exactly 3.

- If we have only 2 literals for a clause, create arbitrary variables p and p negated, and make 2 3-literals clauses.
- If we have only 1 literals for a clause, create 2 arbitrary variables, and convert to 4 clauses with all the combination.


## CLIQUE

Basically a clique is a set of vertices in a graph such that all the vertices inside of the set are connected.
They can be of different sizes, every edge is a clique of size 2.

The certificate is the proposed clique. Check that every vertex belongs to the graph, check that clique has correct size, check that every edge that you find is in the set of edges.

We can show that 3-CNF-SAT reduces to clique ($\text{3-CNF-SAT} \leq_P \text{CLIQUE}$).

(G, k) with k as the number of clauses in my formulas.
We need to find formulas that are satisfiable if and only if bla bla bla

### How to convert (30)

#### from sat to clique

For every clause and for every literal of a clause, i add some nodes.

Imagine we have a graph, and for each clause we have a triplet of nodes (literals), basically one vertex for every literal.
I will put an edge between every pair of literals that are from different clauses, but are not complements of each other.

This formula is satisfiable if and only if we have a clique of size 3 in this graph.

Assume that the formula is satisfiable. Since it is in CNF, every clause has at least one literal that is 1. 
For every clause, we choose one literal that is 1. This corresponds to a set of vertices in my graph with exactly size k. Then we claim that these k nodes are all pairwise connected.

Basically this construction makes it so that if the formula is satisfiable, then we have a clique of size k.

#### from clique to sat

Suppose that the graph has a clique of size k.

## VERTEX-COVER

A vertex cover is a set of vertices that is connected to all leaves in the graph. We want to find the smallest vertex-cover, the smallest number of nodes that can cover all the graph.

We can convert this to a decision problem: does this graph have a vertex cover of size k?

### Reduction from CLIQUE

I want to invent a new graph such that G has a clique of size k if and only if G' has a vertex cover of size k'.

G' will be the complement of G. Same vertices, but with edges where the original graph doesn't have edges.

G has a clique of size k, if and only if the complement of G has a vertex cover of size |V| - k.

Imagine that G has a clique of size V' of size k.
We claim that V\V' is a vertex cover for G.
Why?
Let {u,v} be any edge in the complement of E, so it was not in E to begin with.
I fix an edge in the complement graph, and since this edge is not present in the original graph, at least one of them will be outside the clique.

Now the other side.
We take a pair of vertices that do not belong to V'. 
He's speaking too much symbols, i am not understanding.

## HAM-PATH

### Conversion from 3-CNF-SAT (30 e lode)

The idea is that we have some way to represent this formula as a graph.
We represent each variable as a double way linked chain on k nodes (k = number of clauses).

We interconnect each edge of the row with another external vertex (above and below each row).
The extremes of the row are only there to make the graph...

There are 2 nodes that speak about the presence of a variable in a clause, then a separator, then again 2 nodes, then separator, and so on.

SEPARATOR | NODE IN A CLAUSE | SEPARATOR | NODE IN A CLAUSE

Suppose $c_j$ is a clause.
We have an external node $c_j$, and for each pair of nodes (that are not separators), we put edges that go to or from this external node $c_j$. 
- If the variable is not negated inside the clause $c_j$, we go from the left node and we come back from $c_j$ in the right node
- If the variable is negated inside $c_j$, we go from the right node to $c_j$, and we come back to the left node.

> [!hint]
> It's not strictly required to have 3k+3, you can have 2k+2, but then it's more difficult...?


Now we have to prove that once we have a satisfiable assignment for a formula, we should be able to find an hamiltonian path.
Conversely, from an hamiltonian path, we should be able to recover an assignment that is satisfiable for a formula.

## Undirected HAM-PATH

Edges are not pairs of vertices (ordered), they are just subsets of vertices now.
We want to prove this is in NPC aswell.

Assume we have a directed graph G with n vertices, i want to build an undirected graph G', such that G is hamiltonian if and only if G' is hamiltonian.

I split every node in G in 3 new chained nodes in G'.
Then for every original edge in my graph, i add an edge between the third new vertex of each chain to the first vertex of the next node in the original graph

![[photo_2025-11-26_09-00-29.jpg]]

The only possibility is:
- visiting a triple
- moving to another triple (if we go back it's not hamiltonian anymore)

> [!hint]
> We can't duplicate the vertices, we must triplicate them. Because then the iff wouldn't hold.


## HAM-CYCLE

HAM-PATH, but the start and stop node are connected by an edge.
We reduce it from HAM-PATH to prove it's in NPC.

My original graph has n vertices, i add 1, between the first and last nodes (which should touch because this is a cycle): 
$$\Large u_1, \dots, t,v,s,\dots,u_n+2$$


If i have an ham-path from s to t in G, trivially, from v to s (passing through all the ham-path) and then to t...
I simply forget the first and last edge, and what remains is an ham-path. 
This is trivial if v is outside, but if the cycle starts from some internal node u, then?


## TSP (traveling salesman)

A salesman must visit the n cities with the lowest cost tour.
So basically we must find the path that touches some vertices with the lowest cost possible (all vertices must be touched once).

We assume that we have a complete graph, so you can go from every city to every other city.

> [!hint]
> Since this is a fully connected graph, there is always an ham-path (but we don't really give a shit).


### Conversion from ham-cycle

We start with the graph from the ham-cycle, and we complete it (we add all the missing edges), to get a fully connected graph.

If an edge was present in the original graph, its cost is 0, if it was not, its cost is 1.
The point is that we sum all the paths that we take, and if the cost of the entire path is 0, it means that we found a path that was in the original graph.

> [!hint]
> This should be an optimization problem, but we focus on decision problems here. So the point is to ask like: is there a ham-cycle of cost? length? k? Apparently its the same here, the edges in the original graph all have the same cost apparently.

![[Pasted image 20251129091054.png]]